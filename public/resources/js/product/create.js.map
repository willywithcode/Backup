{"version":3,"file":"/resources/js/product/create.js","mappings":"qiCACA,IAAIA,EAAa,IAAIC,MAAM,8BAA+B,CACtDC,QAAS,CACLC,QAAS,CACL,CAAC,CACGC,OAAQ,CAAC,EAAG,GAAG,KAEnB,CAAC,OAAQ,SAAU,aACnB,CAAC,QAAS,gBAGlBC,MAAO,SAIPC,EAAS,GAEI,IAAIC,SAAS,qBAAsB,CAChDC,IAAK,IACLC,UAAW,OACXC,SAAU,GACVC,YAAa,GACbC,gBAAgB,EAChBC,OAAQ,SAAUC,EAAMC,GACpBT,EAAOU,KAAK,CACRC,KAAMH,EAAKG,KACXH,KAAAA,GAER,IAGJI,EAAE,6BAA6BC,YAE/B,IAAIC,EAAY,EAEhBF,EAAE,oBAAoBG,OAAM,SAAUC,GAClCA,EAAEC,iBACF,IAAIC,EAAUN,EAAE,YAAYO,OACxBC,EAASF,EAAQG,QACrBD,EAAOE,KAAK,SAASC,IAAI,IACzBT,IACAM,EAAOI,KAAK,KAAM,WAAaV,GAC/BM,EAAOE,KAAK,KAAKG,IAAI,CACjB,QAAW,EACX,OAAU,YAEdL,EAAOE,KAAK,0BAA0BI,QAAQC,KAAK,IACnDT,EAAQU,MAAMR,EAClB,IAEAR,EAAEiB,UAAUC,GAAG,QAAS,uBAAuB,SAASd,GACpDA,EAAEC,iBAC4B,GAA1BL,EAAEmB,MAAMN,IAAI,YACZb,EAAEmB,MAAMC,SAASA,SAASA,SAASC,QAE3C,IAGArB,EAAE,eAAekB,GAAG,SAAS,SAACd,GAG1B,GAFAA,EAAEC,kBAgDN,WACIL,EAAE,0BAA0Be,KAAK,IAEjC,IAAIO,GAAW,EAuBf,OAtBAtB,EAAE,YAAYuB,MAAK,WACf,IAAIC,GAAU,EACdxB,EAAEmB,MAAMT,KAAK,UAAUa,MAAK,WACnBvB,EAAEmB,MAAMR,QAETa,GAAU,EAGlB,IACAxB,EAAEmB,MAAMT,KAAK,SAASa,MAAK,WAClBvB,EAAEmB,MAAMR,QAETa,GAAU,EAGlB,IACIA,IACAF,GAAW,EACXtB,EAAEmB,MAAMT,KAAK,0BAA0BK,KAAK,kCAEpD,IAEOO,CACX,CAzEQG,GAAJ,CAIA,IAAMC,EAAc5C,EAAW6C,KAAKC,UACpC5B,EAAE,wBAAwBW,IAAIe,GAC9B,IAAMG,EAAW,IAAIC,SAASb,SAASc,eAAe,kCACtD3C,EAAO4C,SAAQ,SAACC,GACZJ,EAASK,OAAO,WAAYD,EAAMrC,KAAMqC,EAAMlC,KAClD,IAEAC,EAAEmC,KAAK,CACHC,KAAM,OACNC,QAAS,sBACT/C,IAAK,YACLgD,KAAMT,EACNU,aAAa,EACbC,aAAa,EACbC,OAAO,EACPC,QAAS,WACLC,OAAOC,aAAaC,QAAQ,UAAW,wBACvCF,OAAOG,SAASC,KAAO,WAC3B,EACAC,MAAO,SAAUV,GACO,MAAhBA,EAAKW,SACLjD,EAAE,kBAAkBuB,MAAK,WACrBvB,EAAEmB,MAAMJ,KAAK,IACb,IAAMmC,EAAelD,EAAEmB,MAAMC,SAAS+B,SAAS,SAC3CD,GACAA,EAAaE,YAAY,aAEjC,IAEAC,OAAOC,QAAQhB,EAAKiB,aAAaC,QAAQxB,SAAQ,SAAAyB,GAAgB,IAAAC,EAAAC,EAAAF,EAAA,GAAdG,EAAGF,EAAA,GAAE/C,EAAG+C,EAAA,GACvD1D,EAAE,kBAAD6D,OAAmBD,IAAO1B,OAAO,UAAD2B,OAAWlD,EAAI,GAAE,aAClDX,EAAE,kBAAD6D,OAAmBD,IAAO/C,IAAI,UAAW,SAC1C,IAAMqC,EAAelD,EAAE,kBAAD6D,OAAmBD,IAAOxC,SAAS+B,SAAS,SAC9DD,GACAA,EAAaY,SAAS,aAE9B,IAER,GAxCJ,CA0CJ,G","sources":["webpack:///./resources/js/product/create.js"],"sourcesContent":["// Description editor\nvar fullEditor = new Quill('#product-description-editor', {\n    modules: {\n        toolbar: [\n            [{\n                header: [1, 2, false]\n            }],\n            ['bold', 'italic', 'underline'],\n            ['image', 'code-block']\n        ]\n    },\n    theme: 'snow' // or 'bubble'\n});\n\n// Product images\nvar images = [];\n\nvar myDropzone = new Dropzone(\"#add_product_media\", {\n    url: '#',\n    paramName: 'file', // The name that will be used to transfer the file\n    maxFiles: 10,\n    maxFilesize: 10, // MB\n    addRemoveLinks: true,\n    accept: function (file, done) {\n        images.push({\n            name: file.name,\n            file,\n        });\n    }\n});\n\n$(\"#discount-deadline-picker\").flatpickr();\n\nlet variantId = 1;\n// Add product variant\n$('#add-variant-btn').click(function (e) {\n    e.preventDefault();\n    var lastRow = $('.variant').last(); // select the last row\n    var newRow = lastRow.clone(); // clone the last row\n    newRow.find('input').val(''); // clear the values of the inputs in the new row\n    variantId++;\n    newRow.attr('id', 'variant-' + variantId);\n    newRow.find('a').css({\n        'opacity': 1,\n        'cursor': 'pointer',\n    });\n    newRow.find('.variant-error-message').first().html('');\n    lastRow.after(newRow); // insert the new row after the last row\n});\n\n$(document).on('click', '.remove-variant-btn', function(e) {\n    e.preventDefault();\n    if ($(this).css('opacity') == 1) {\n        $(this).parent().parent().parent().remove();\n    }\n});\n\n// Add product submit\n$('#submit-btn').on('click', (e) => {\n    e.preventDefault();\n\n    if (validateProductVariants()) {\n        return;\n    }\n\n    const description = fullEditor.root.innerHTML;\n    $('#product-description').val(description);\n    const formData = new FormData(document.getElementById('kt_ecommerce_add_product_form'));\n    images.forEach((image) => {\n        formData.append('images[]', image.file, image.name);\n    });\n\n    $.ajax({\n        type: 'POST',\n        enctype: 'multipart/form-data',\n        url: '/products',\n        data: formData,\n        processData: false,\n        contentType: false,\n        cache: false,\n        success: function () {\n            window.localStorage.setItem('success', 'Thêm mới thành công!');\n            window.location.href = '/products';\n        },\n        error: function (data) {\n            if (data.status === 422) {\n                $('.error-message').each(function () {\n                    $(this).html('');\n                    const inputElement = $(this).parent().children('input');\n                    if (inputElement) {\n                        inputElement.removeClass('is-invalid');\n                    }\n                });\n\n                Object.entries(data.responseJSON.errors).forEach(([key, val]) => {\n                    $(`#error-message-${key}`).append(`<small>${val[0]}</small>`);\n                    $(`#error-message-${key}`).css('display', 'block');\n                    const inputElement = $(`#error-message-${key}`).parent().children('input');\n                    if (inputElement) {\n                        inputElement.addClass('is-invalid');\n                    }\n                });\n            }\n        },\n    });\n});\n\nfunction validateProductVariants() {\n    $('.variant-error-message').html('');\n\n    let hasError = false;\n    $('.variant').each(function() {\n        let isError = false;\n        $(this).find('select').each(function() {\n            if (!$(this).val()) {\n                // $(this).addClass('is-invalid');\n                isError = true;\n                return;\n            }\n        });\n        $(this).find('input').each(function() {\n            if (!$(this).val()) {\n                // $(this).addClass('is-invalid');\n                isError = true;\n                return;\n            }\n        });\n        if (isError) {\n            hasError = true;\n            $(this).find('.variant-error-message').html(`<small>Trường bắt buộc</small>`)\n        }\n    });\n\n    return hasError;\n}\n"],"names":["fullEditor","Quill","modules","toolbar","header","theme","images","Dropzone","url","paramName","maxFiles","maxFilesize","addRemoveLinks","accept","file","done","push","name","$","flatpickr","variantId","click","e","preventDefault","lastRow","last","newRow","clone","find","val","attr","css","first","html","after","document","on","this","parent","remove","hasError","each","isError","validateProductVariants","description","root","innerHTML","formData","FormData","getElementById","forEach","image","append","ajax","type","enctype","data","processData","contentType","cache","success","window","localStorage","setItem","location","href","error","status","inputElement","children","removeClass","Object","entries","responseJSON","errors","_ref","_ref2","_slicedToArray","key","concat","addClass"],"sourceRoot":""}